
### [Example Performance-Critical Knobs (for MySQL)](https://www.percona.com/blog/2020/06/30/mysql-101-parameters-to-tune-for-mysql-performance/)

Note *M* denotes the manually selected knobs.

| Knob Name                       |    Selected by    |                                                                                                                            Note                                                                                                                            |     Global     | Dynamic |        Type         |         Default Value         | Minimum Value |    Maximum Value     | Tuning Experience                                                                                                                                                                                                                                  |
|:--------------------------------|:-----------------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:--------------:|:-------:|:-------------------:|:-----------------------------:|:-------------:|:--------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| innodb_buffer_pool_size         | M;QTune;OtterTune |                                                                                 innodb_buffer_pool_size = N * innodb_buffer_pool_chunk_size * innodb_buffer_pool_instances                                                                                 |       ✅        |    ✅    |       Integer       |    134217728 bytes (128MB)    |    5242880    | 9223372036854775807  | might set the buffer pool size to 50%-70% of the machine's physical memory size.When the size of the buffer pool is greater than 1GB, setting innodb_buffer_pool_instances to a value greater than 1 can improve the scalability on a busy server. |
| ~~innodb_log_file_size~~        |    M;OtterTune    |                                                                                                                     8.0.30 Deprecated                                                                                                                      |       ✅        |    ❌    |       Integer       |           50331648            | 4194304 (4MB) | 18446744073709551615 | set the size 128M-2G，                                                                                                                                                                                                                              |
| innodb_redo_log_capacity        |         M         |                                                                              8.0.30 introduced, supersedes the innodb_log_files_in_group and innodb_log_file_size variables.                                                                               |       ✅        |    ✅    |       Integer       |           104857600           |    8388608    |     137438953472     |                                                                                                                                                                                                                                                    |
| innodb_flush_log_at_trx_commit  |         M         |                                                                                                                             -                                                                                                                              |       ✅        |    ✅    | Enumeration (0，1，2) |               1               |       -       |          -           | The default setting of 1 is required for full ACID compliance. With a setting of 0, logs are written and flushed to disk once per second.                                                                                                          |
| innodb_flush_method             |    M;OtterTune    |                                                                                                     In MySQL 8.0, options can be specified numerically                                                                                                     |       ✅        |    ❌    |       String        | Unix:fsync Windows:unbuffered |               |                      | Defines the method used to flush data to InnoDB data files and log files, which can affect I/O throughput.                                                                                                                                         | 
| innodb_file_per_table           |         M         |                                                                                                                             -                                                                                                                              |       ✅        |    ✅    |       Boolean       |              NO               |               |                      |                                                                                                                                                                                                                                                    |
| innodb_stats_on_metadata        |         M         |                                                                                               SET GLOBAL innodb_stats_on_metadata=mode (mode = ON/OFF; 1/0;)                                                                                               |       ✅        |    ✅    |       Boolean       |              OFF              |               |                      | Leaving the setting disabled can improve access speed for schemas that have a large number of tables or indexes.                                                                                                                                   |
| innodb_buffer_pool_instances    |    M;OtterTune    |                                                                                                               innodb_buffer_pool_size >= 1GB                                                                                                               |       ✅        |    ❌    |       Integer       |                               |       1       |          64          |                                                                                                                                                                                                                                                    |
| ~~~query_cache_type~~~          |         M         |                                                                                                                  Removed in MySQL 8.0.3.                                                                                                                   |                |         |                     |                               |               |                      |                                                                                                                                                                                                                                                    |
| ~~~query_cache_size~~~          |         M         |                                                                                                                  Removed in MySQL 8.0.3.                                                                                                                   |                |         |                     |                               |               |                      |                                                                                                                                                                                                                                                    |
| ~~~query_cache_limit~~~         |         M         |                                                                                                                  Removed in MySQL 8.0.3.                                                                                                                   |                |         |                     |                               |               |                      |                                                                                                                                                                                                                                                    |
| innodb_autoinc_lock_mode        |         M         |                                                                                                 The lock mode to use for generating auto-increment values.                                                                                                 |       ✅        |    ❌    |       Integer       |               2               |               |                      | 0,1,2 for traditional, consecutive, or interleaved                                                                                                                                                                                                 |
| innodb_io_capacity              |         M         |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |              200              |      100      |          ?           | The innodb_io_capacity variable defines the number of I/O operations per second (IOPS) available to InnoDB background tasks                                                                                                                        |
| innodb_io_capacity_max          |         M         |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |                               |      100      |                      |                                                                                                                                                                                                                                                    |
| max_connections                 |      M;QTune      |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |              151              |       1       |       	100000        |                                                                                                                                                                                                                                                    |
| table_open_cache                |       QTune       |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |             4000              |       1       |        524288        | MAX( (open_files_limit - 10 - max_connections) / 2, 400)                                                                                                                                                                                           |
| join_buffer_size                |       QTune       | The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.In MySQL 8.0.18 and later, this variable also controls the amount of memory used for hash joins. | ✅<br/> Session |    ✅    |       Integer       |        262144 (256KB)         |      128      |                      | Normally, the best way to get fast joins is to add indexes. Increase the value of join_buffer_size to get a faster full join when adding indexes is not possible.                                                                                  |
| key_buffer_size                 |       QTune       |                                                                                                               0 is permitted only at startup                                                                                                               |       ✅        |    ✅    |       Integer       |            8388608            |       0       |                      | the size of the buffer used for index blocks. The key buffer is also known as the key cache.                                                                                                                                                       |
| preload_buffer_size             |       QTune       |                                                                                                                                                                                                                                                            | ✅<br/> Session |    ✅    |       Integer       |             32768             |     1024      |      1073741824      | The size of the buffer that is allocated when preloading indexes.                                                                                                                                                                                  |
| sort_buffer_size                |       QTune       |                                                                   If many Sort_merge_passes per second in SHOW GLOBAL STATUS output, can consider increasing the sort_buffer_size value                                                                    | ✅<br/> Session |    ✅    |       Integer       |            262144             |     32768     |                      |                                                                                                                                                                                                                                                    |
| binlog_cache_size               |       QTune       |                                                                                                                      block size 4096                                                                                                                       |       ✅        |    ✅    |       Integer       |             32768             |     4096      |                      | The size of the memory buffer to hold changes to the binary log during a transaction.                                                                                                                                                              |
| ~~~max_length_for_sort_data~~~  |       QTune       |                                                                                                                     8.0.20 Deprecated                                                                                                                      |                |         |                     |                               |               |                      |                                                                                                                                                                                                                                                    |
| max_prepared_stmt_count         |       QTune       |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |             16382             |       0       |       4194303        | This variable limits the total number of prepared statements in the server.                                                                                                                                                                        |
| max_sp_recursion_depth          |       QTune       |                                             If you increase the value of max_sp_recursion_depth, it may be necessary to increase thread stack size by increasing the value of thread_stack at server startup.                                              | ✅<br/> Session |    ✅    |       Integer       |               0               |       0       |         255          |                                                                                                                                                                                                                                                    |
| max_user_connections            |       QTune       |                                                                                                                                                                                                                                                            | ✅<br/> Session |    ✅    |       Integer       |               0               |       0       |      4294967295      | The maximum number of simultaneous connections permitted to any given MySQL user account. A value of 0 (the default) means “no limit.”                                                                                                             |
| innodb_thread_sleep_delay       |     OtterTune     |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |             10000             |       0       |       1000000        | How long InnoDB threads sleep before joining the InnoDB queue, in microseconds.                                                                                                                                                                    |
| innodb_thread_concurrency       |     OtterTune     |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |               0               |       0       |         1000         | Defines the maximum number of threads permitted inside of InnoDB. A value of 0 (the default) is interpreted as infinite concurrency (no limit). This variable is intended for performance tuning on high concurrency systems.                      |
| innodb_max_dirty_pages_pct_lwm  |     OtterTune     |                                                                                                      lower than the innodb_max_dirty_pages_pct value                                                                                                       |       ✅        |    ✅    |       Numeric       |              10               |       0       |        99.99         | A value of 0 disables the pre-flushing behavior entirely.                                                                                                                                                                                          |
| innodb_read_ahead_threshold     |     OtterTune     |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |              56               |       0       |          64          |                                                                                                                                                                                                                                                    |
| innodb_adaptive_max_sleep_delay |     OtterTune     |                                                                                                                innodb_thread_sleep_delay的上限                                                                                                                |       ✅        |    ✅    |       Integer       |            150000             |       0       |       1000000        |                                                                                                                                                                                                                                                    |
| thread_cache_size               |     OtterTune     |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |        -1 (autosizing)        |       0       |        16384         |                                                                                                                                                                                                                                                    |
| tmp_table_size                  |        PKU        |                                                                                                                                                                                                                                                            | ✅<br/> Session |    ✅    |       Integer       |           16777216            |     1024      | 18446744073709551615 | Defines the maximum size of internal in-memory temporary tables created by the MEMORY storage engine and, as of MySQL 8.0.28, the TempTable storage engine.                                                                                        |
| max_heap_table_size             |        PKU        |                                                                                                                                                                                                                                                            | ✅<br/> Session |    ✅    |       Integer       |           16777216            |     16384     |                      | block size 1024                                                                                                                                                                                                                                    |
| innodb_spin_wait_delay          |        PKU        |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |       Integer       |               6               |       0       |         1000         | The maximum delay between polls for a spin lock.                                                                                                                                                                                                   |
| ~~~query_prealloc_size~~~       |        PKU        |                                                                                                                     8.0.29 Deprecated                                                                                                                      | ✅<br/> Session |    ✅    |       Integer       |             8192              |     8192      |                      |                                                                                                                                                                                                                                                    |
| innodb_doublewrite              |        PKU        |                                                                                                                                                                                                                                                            |       ✅        |    ✅    |     Enumeration     |              ON               |               |                      | 	ON OFF DETECT_AND_RECOVER DETECT_ONLY                                                                                                                                                                                                             |
|                                 |                   |                                                                                                                                                                                                                                                            |                |         |                     |                               |               |                      |                                                                                                                                                                                                                                                    |
|                                 |                   |                                                                                                                                                                                                                                                            |                |         |                     |                               |               |                      |                                                                                                                                                                                                                                                    |






***(VM) Hardware relevant knobs***

(1) innodb_buffer_pool_size  
    ---innodb_buffer_pool_size = N * innodb_buffer_pool_chunk_size * innodb_buffer_pool_instances

(2) innodb_log_file_size  

(3) innodb_flush_log_at_trx_commit 

(4) innodb_flush_method

***Best Performance Practices***   

(1) innodb_file_per_table   

(2) innodb_stats_on_metadata

(3) innodb_buffer_pool_instances

(4) query_cache_type & query_cache_size
